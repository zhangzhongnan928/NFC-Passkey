"use strict";var t=require("../../Error.js");exports.linkWithCrossAppAuth=({client:r,openAuthSession:e})=>async({providerAppId:i,redirectUrl:a})=>{let n=`privy:${i}`,{url:o}=await r.auth.oauth.generateURL(n,a),s=await e(o),u=s.privy_oauth_state,h=s.privy_oauth_code;if(!u||!h)throw new t.PrivyClientError({code:"login_with_oauth_returned_with_invalid_credentials",error:"Auth session oauth returned invalid credentials"});let d=r.addOAuthTokensListener((t=>{r.crossApp.updateOnCrossAppAuthentication(i,t)})),{user:p}=await r.auth.oauth.linkWithCode(h,u,n);return d.unsubscribe(),p};
