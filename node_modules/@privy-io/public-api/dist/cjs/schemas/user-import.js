"use strict";var e=require("zod"),t=require("./core.js"),o=require("./embedded-wallet-creation.js"),s=require("./user.js");require("bs58"),require("libphonenumber-js/max"),require("viem"),require("./wallet-api/wallets.js"),require("@privy-io/api-base"),require("./api.js"),require("./transaction.js"),require("./wallet-api/export.js"),require("./smart-wallet-config.js"),require("../constants/smart-wallets.js");const a=e.z.object({type:e.z.literal("wallet"),address:e.z.union([t.WalletAddress,t.SolanaWalletAddress]),chain_type:e.z.enum(["ethereum","solana"])}),n=e.z.object({type:e.z.literal("email"),address:t.Email}),c=e.z.object({type:e.z.literal("phone"),number:t.PhoneNumber}),r=e.z.object({type:e.z.literal("google_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),email:t.Email,name:e.z.string()}).strict(),u=e.z.object({type:e.z.literal("twitter_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),name:e.z.string().min(1).max(50),username:e.z.string().regex(/^[0-9a-zA-Z|\_]{1,15}$/),profile_picture_url:e.z.string().url().refine((e=>e.startsWith("https://abs.twimg.com/sticky/default_profile_images/")||e.startsWith("https://pbs.twimg.com/profile_images/"))).optional()}).strict(),i=e.z.object({type:e.z.literal("discord_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),username:e.z.string().regex(/^(?!discord|everyone|here)[0-9a-zA-Z_.]{2,32}(?:#(?:[0-9]{4}|0))?$/).transform((e=>e.includes("#")?e:`${e}#0`)),email:t.Email.optional()}).strict(),l=e.z.object({type:e.z.literal("spotify_oauth"),subject:e.z.string(),name:e.z.string().optional(),email:t.Email.optional()}).strict(),m=e.z.object({type:e.z.literal("github_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),username:e.z.string().regex(/^[a-zA-Z0-9]+(?:-[a-zA-Z0-9]+)*$/).max(39),name:e.z.string().optional(),email:t.Email.optional()}).strict(),d=e.z.object({type:e.z.literal("instagram_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),username:e.z.string().regex(/^(?!instagram|everyone|here)[0-9a-zA-Z._]{2,32}$/)}).strict(),p=e.z.object({type:e.z.literal("tiktok_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),username:e.z.string().regex(/^(?!tiktok|everyone|here)[0-9a-zA-Z]{2,32}$/),name:e.z.string().min(1).max(30).nullable()}).strict(),h=e.z.object({type:e.z.literal("linkedin_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),name:e.z.string().optional(),email:t.Email.optional(),vanityName:e.z.string().optional()}).strict(),g=e.z.object({type:e.z.literal("apple_oauth"),subject:e.z.string().regex(/^[\x00-\x7F]{1,256}$/),email:t.Email.optional()}).strict(),_=e.z.object({type:e.z.literal("farcaster"),fid:e.z.number().int(),owner_address:t.WalletAddress,username:e.z.string().max(256).optional(),display_name:e.z.string().max(32).optional(),bio:e.z.string().max(256).optional(),profile_picture_url:e.z.string().max(256).optional(),homepage_url:e.z.string().max(256).optional()}).strict(),z=e.z.object({type:e.z.literal("telegram"),telegram_user_id:e.z.string().min(1).max(255),first_name:e.z.string().max(255).optional(),last_name:e.z.string().max(255).optional(),username:e.z.string().max(255).optional(),photo_url:e.z.string().max(255).optional()}).strict(),A=e.z.object({type:e.z.literal("custom_auth"),custom_user_id:e.z.string().min(1).max(256)}).strict(),b=e.z.discriminatedUnion("type",[a,n,c,r,u,i,m,l,d,p,g,h,_,z,A]);let I=b.array().min(1).transform((e=>{let t={emailAccounts:[],phoneAccounts:[],ethereumAccounts:[],solanaAccounts:[],googleAccounts:[],twitterAccounts:[],discordAccounts:[],githubAccounts:[],spotifyAccounts:[],instagramAccounts:[],tiktokAccounts:[],linkedinAccounts:[],appleAccounts:[],farcasterAccounts:[],telegramAccounts:[],customJwtAccounts:[]};for(let o of e)switch(o.type){case"wallet":"ethereum"===o.chain_type&&t.ethereumAccounts.push(o),"solana"===o.chain_type&&t.solanaAccounts.push(o);break;case"email":t.emailAccounts.push(o);break;case"phone":t.phoneAccounts.push(o);break;case"google_oauth":t.googleAccounts.push(o);break;case"twitter_oauth":t.twitterAccounts.push(o);break;case"discord_oauth":t.discordAccounts.push(o);break;case"github_oauth":t.githubAccounts.push(o);break;case"spotify_oauth":t.spotifyAccounts.push(o);break;case"instagram_oauth":t.instagramAccounts.push(o);break;case"tiktok_oauth":t.tiktokAccounts.push(o);break;case"linkedin_oauth":t.linkedinAccounts.push(o);break;case"apple_oauth":t.appleAccounts.push(o);break;case"farcaster":t.farcasterAccounts.push(o);break;case"telegram":t.telegramAccounts.push(o);break;case"custom_auth":t.customJwtAccounts.push(o)}return t})).superRefine(((t,o)=>{t.emailAccounts&&t.emailAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one email account."}),t.phoneAccounts&&t.phoneAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one phone number account."}),t.googleAccounts&&t.googleAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Google account."}),t.linkedinAccounts&&t.linkedinAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one LinkedIn account."}),t.twitterAccounts&&t.twitterAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Twitter account."}),t.discordAccounts&&t.discordAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Discord account."}),t.githubAccounts&&t.githubAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one GitHub account."}),t.tiktokAccounts&&t.tiktokAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Tiktok account."}),t.spotifyAccounts&&t.spotifyAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Spotify account."}),t.instagramAccounts&&t.instagramAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Instagram account."}),t.appleAccounts&&t.appleAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Apple account."}),t.farcasterAccounts&&t.farcasterAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Farcaster account."}),t.telegramAccounts&&t.telegramAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one Telegram account."}),t.customJwtAccounts&&t.customJwtAccounts.length>0&&(t.customJwtAccounts.length>1&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User cannot have more than one custom JWT account."}),t.ethereumAccounts.length+t.emailAccounts.length+t.phoneAccounts.length+t.appleAccounts.length+t.discordAccounts.length+t.githubAccounts.length+t.googleAccounts.length+t.spotifyAccounts.length+t.instagramAccounts.length+t.linkedinAccounts.length+t.twitterAccounts.length+t.tiktokAccounts.length+t.telegramAccounts.length+t.farcasterAccounts.length!==0&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"User with custom JWT account cannot be imported with other linked accounts."}))}));const x=e.z.object({create_embedded_wallet:e.z.boolean().optional(),create_n_embedded_wallets:e.z.number().min(1).max(10).optional(),create_n_ethereum_wallets:e.z.number().min(1).max(10).optional(),create_ethereum_wallet:e.z.boolean().optional(),create_solana_wallet:e.z.boolean().optional(),create_ethereum_smart_wallet:e.z.boolean().optional()}).strict(),w=o.EmbeddedWalletCreationInput.merge(x),k=w.extend({linked_accounts:I,custom_metadata:s.CustomMetadata.optional()}).superRefine(((t,o)=>{void 0!==t.create_embedded_wallet&&void 0!==t.create_n_ethereum_wallets&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"create_embedded_wallet is deprecated, use create_ethereum_wallet instead"}),void 0!==t.create_ethereum_wallet&&void 0!==t.create_n_embedded_wallets&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"create_n_embedded_wallets is deprecated, use create_n_ethereum_wallets instead"}),t.create_ethereum_smart_wallet&&!t.create_ethereum_wallet&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"create_ethereum_smart_wallet requires create_ethereum_wallet to be true"})})),y=e.z.object({users:k.array().max(20)}),f=e.z.object({create_ethereum_wallet:e.z.boolean().optional(),number_of_ethereum_wallets_to_create:e.z.number().min(1).max(10).optional(),create_ethereum_smart_wallet:e.z.boolean().optional(),create_solana_wallet:e.z.boolean().optional()}).strict();const j=o.EmbeddedWalletCreationInput.merge(f).extend({user_id:t.UserId}).superRefine(((t,o)=>{t.create_ethereum_smart_wallet&&!t.create_ethereum_wallet&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"create_ethereum_smart_wallet requires create_ethereum_wallet to be true"}),!t.create_ethereum_wallet&&t.number_of_ethereum_wallets_to_create&&o.addIssue({code:e.z.ZodIssueCode.custom,message:"create_ethereum_wallet must be true if number_of_ethereum_wallets_to_create is specified"})}));exports.CreateEmbeddedWalletUserImportInput=x,exports.CreateWalletInput=f,exports.EmbeddedWalletCreationInputUnion=w,exports.ImportAppleAccountInput=g,exports.ImportCustomJwtAccountInput=A,exports.ImportDiscordAccountInput=i,exports.ImportEmailAccountInput=n,exports.ImportFarcasterAccountInput=_,exports.ImportGithubAccountInput=m,exports.ImportGoogleAccountInput=r,exports.ImportInstagramAccountInput=d,exports.ImportLinkedInAccountInput=h,exports.ImportManyUsersInput=y,exports.ImportPhoneAccountInput=c,exports.ImportSpotifyAccountInput=l,exports.ImportTelegramAccountInput=z,exports.ImportTiktokAccountInput=p,exports.ImportTwitterAccountInput=u,exports.ImportUserInput=k,exports.ImportWalletAccountInput=a,exports.LinkedAccountInput=b,exports.WalletCreateUserInput=j;
