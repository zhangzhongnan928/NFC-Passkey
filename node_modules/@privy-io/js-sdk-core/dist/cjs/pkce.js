"use strict";var e=require("jose");async function r(e,r){let t=(new TextEncoder).encode(e);return new Uint8Array(await r("SHA-256",t))}function t(e){return crypto.getRandomValues(new Uint8Array(e))}function n(){return e.base64url.encode(t(36))}exports.CODE_VERIFIER_KEY="privy:code_verifier",exports.STATE_CODE_KEY="privy:state_code",exports.createCodeVerifier=n,exports.createHashBuffer=r,exports.createStateCode=function(){return n()},exports.deriveCodeChallengeFromCodeVerifier=async function({codeVerifier:t,method:n="S256",digest:o=crypto.subtle.digest.bind(crypto.subtle)}){if("S256"!=n)return t;{let n=await r(t,o);return e.base64url.encode(n)}},exports.randomBytes=t;
