"use strict";var e=require("zod"),t=require("@privy-io/api-base"),i=require("../api.js"),a=require("../core.js"),r=require("../transaction.js"),n=require("./export.js");require("bs58"),require("libphonenumber-js/max"),require("viem");const o=e.z.enum(["secp256k1","ed25519"]),s=e.z.string().regex(/^[mM]'?(\/\d+'?)*$/),l=e.z.literal("ECDSA"),p=e.z.literal("EdDSA"),c=e.z.union([l,p]),z=e.z.string().regex(/^[-a-z0-9]{3,8}:[-_a-zA-Z0-9]{1,32}$/,"Chain ID must be a valid CAIP-2 chain ID, e.g. 'eip155:1'");let d=e.z.object({address:a.SolanaWalletAddress.optional(),chain_type:e.z.literal("solana").optional(),wallet_id:e.z.string().optional()}),u=e.z.object({address:a.WalletAddress.optional(),chain_type:e.z.literal("ethereum").optional(),wallet_id:e.z.string().optional()});const g=e.z.enum(["root","manager","delegated-actions"]).nullable(),h=e.z.object({method:e.z.literal("signTransaction"),params:e.z.object({transaction:e.z.string(),encoding:e.z.literal("base64")}).strict()}).merge(d).strict(),m=e.z.object({method:e.z.literal("signAndSendTransaction"),caip2:z,params:e.z.object({transaction:e.z.string(),encoding:e.z.literal("base64")}).strict()}).merge(d).strict(),_=e.z.object({method:e.z.literal("signMessage"),params:e.z.object({message:e.z.string(),encoding:e.z.literal("base64")}).strict()}).merge(d).strict(),b=e.z.string().startsWith("0x").refine((e=>!e.includes(".")),"Invalid hex string: must start with '0x' and not contain decimal points"),x=b.transform((e=>e));let y=e.z.number().int().nonnegative().safe({message:'Please use hex string prefixed with "0x" to represent large numbers (e.g. "0xDE0B6B3A7640000").'});const j=e.z.union([b,y],{invalid_type_error:"Invalid quantity: must be either a hex string starting with '0x' or a non-negative integer."}),A=e.z.object({from:a.WalletAddress.optional(),to:a.WalletAddress.optional(),chain_id:j.optional(),nonce:j.optional(),data:b.optional(),value:j.optional(),type:e.z.union([e.z.literal(0),e.z.literal(1),e.z.literal(2)]).optional(),gas_limit:j.optional(),gas_price:j.optional(),max_fee_per_gas:j.optional(),max_priority_fee_per_gas:j.optional()}).strict(),I=e.z.object({method:e.z.literal("eth_signTransaction"),params:e.z.object({transaction:A}).strict()}).merge(u).strict(),v=e.z.object({method:e.z.literal("eth_sendTransaction"),caip2:z,params:e.z.object({transaction:A}).strict()}).merge(u).strict(),R=e.z.object({message:e.z.string(),encoding:e.z.union([e.z.literal("utf-8"),e.z.literal("hex")])}).strict(),W=e.z.object({method:e.z.literal("personal_sign"),params:R}).merge(u).strict(),S=e.z.object({method:e.z.literal("secp256k1_sign"),params:e.z.object({hash:x}).strict()}).merge(u).strict(),T=e.z.object({params:e.z.object({hash:x}).strict()}).strict(),D=e.z.record(e.z.string(),e.z.any()),P=e.z.record(e.z.array(e.z.object({name:e.z.string(),type:e.z.string()}))).refine((e=>"EIP712Domain"in e),{message:"TypedDataTypesInputParams must contain an EIP712Domain key",path:["EIP712Domain"]}),f=e.z.object({method:e.z.literal("eth_signTypedData_v4"),params:e.z.object({typed_data:e.z.object({domain:D,types:P,message:e.z.record(e.z.string(),e.z.any()),primary_type:e.z.string()}).strict()}).strict()}).merge(u).strict(),E=e.z.object({address:e.z.string(),method:e.z.literal("exportPrivateKey"),params:n.PrivateKeyExportInput}).strict(),k=e.z.discriminatedUnion("method",[I,v,W,f,S]),w=e.z.discriminatedUnion("method",[h,m,_]),C=e.z.union([k,w,E]),K=e.z.object({method:e.z.literal("signTransaction"),data:e.z.object({signed_transaction:e.z.string(),encoding:e.z.literal("base64")})}),q=e.z.object({method:e.z.literal("signAndSendTransaction"),data:e.z.object({transaction_id:e.z.string().optional(),hash:e.z.string(),caip2:z}).optional(),error:e.z.object({code:e.z.string(),message:e.z.string()}).optional()}),B=e.z.object({method:e.z.literal("signMessage"),data:e.z.object({signature:e.z.string(),encoding:e.z.literal("base64")})}),U=e.z.object({method:e.z.literal("eth_signTransaction"),data:e.z.object({signed_transaction:e.z.string(),encoding:e.z.literal("rlp")})}),M=e.z.object({method:e.z.literal("eth_sendTransaction"),data:e.z.object({transaction_id:e.z.string().optional(),hash:e.z.string(),caip2:z,transaction_request:A.optional()}).optional(),error:e.z.object({code:e.z.string(),message:e.z.string()}).optional()}),O=e.z.object({method:e.z.literal("personal_sign"),data:e.z.object({signature:e.z.string(),encoding:e.z.literal("hex")})}),F=e.z.object({method:e.z.literal("secp256k1_sign"),data:e.z.object({signature:b,encoding:e.z.literal("hex")})}),G=e.z.object({method:e.z.literal("eth_signTypedData_v4"),data:e.z.object({signature:e.z.string(),encoding:e.z.literal("hex")})}),H=e.z.object({method:e.z.literal("exportPrivateKey"),data:n.PrivateKeyExportInput}),N=e.z.object({data:e.z.object({signature:b,encoding:e.z.literal("hex")}).optional(),error:e.z.object({code:e.z.string(),message:e.z.string()}).optional()}).strict(),L=e.z.discriminatedUnion("method",[K,q,B,U,M,O,F,G,H]),Q=e.z.object({display_name:e.z.string().optional(),public_key:e.z.string(),role:g.optional()}),V=e.z.literal("cosmos"),$=e.z.literal("stellar"),Z=e.z.literal("sui"),J=e.z.union([V,$,Z]),X=e.z.union([e.z.literal("solana"),e.z.literal("ethereum")]),Y=e.z.union([J,X]),ee=e.z.object({id:e.z.string(),address:e.z.string(),public_key:e.z.string().optional(),created_at:e.z.number(),exported_at:e.z.number().nullable(),chain_type:Y,policy_ids:e.z.array(e.z.string()),authorization_threshold:e.z.number().optional(),additional_signers:e.z.array(e.z.object({signer_id:e.z.string().cuid2(),override_policy_ids:e.z.array(e.z.string()).optional()})),owner_id:e.z.string().cuid2().nullable()}),te=e.z.string().cuid2(),ie=e.z.string(),ae=e.z.object({public_key:ie}).strict(),re={owner:ae.nullable().optional(),owner_id:te.nullable().optional()},ne=e.z.array(e.z.string().cuid2()).max(1,"Only one policy ID can be set").optional(),oe=e.z.array(e.z.object({signer_id:te,override_policy_ids:ne}).strict()),se=e.z.object({chain_type:Y,policy_ids:ne,authorization_key_ids:e.z.array(e.z.string()).optional(),authorization_threshold:e.z.number().optional(),additional_signers:oe.optional(),...re}).strict(),le=se.refine((e=>{let t=void 0!==e.authorization_key_ids||void 0!==e.authorization_threshold,i=void 0!==e.additional_signers;return!t||!i}),"Please provide either additional_signers or authorization_key_ids, not both").refine((e=>void 0===e.authorization_threshold||e.authorization_threshold>=1&&e.authorization_key_ids&&e.authorization_threshold<=e.authorization_key_ids.length),{message:"If specified, authorization_threshold must be an integer between 1 and the length of authorization_key_ids."}).refine((e=>!e.owner||!e.owner_id),{message:"Only one of owner or owner_id can be provided."}).catch((e=>{throw new t.InvalidInputError(e.error.message,t.PrivyErrorCode.INVALID_DATA)})),pe=e.z.object({id:e.z.string(),chain_type:Y,address:e.z.string(),authorization_threshold:e.z.number().optional()}),ce=e.z.object({wallet_id:e.z.string({required_error:"Wallet ID must be provided",invalid_type_error:"Wallet ID is not a valid string"}).min(1)}).catch((({error:e})=>{throw new t.InvalidInputError(e.message,t.PrivyErrorCode.INVALID_DATA)})),ze=e.z.enum(["usdc","eth"]),de=e.z.enum(["ethereum","arbitrum","base","linea","optimism","zksync_era"]),ue=e.z.enum(["usd"]),ge=e.z.object({asset:e.z.union([ze,e.z.array(ze).max(10)]),chain:e.z.union([de,e.z.array(de).max(10)]),include_currency:ue.optional()}),he=e.z.object({chain:de,asset:ze,raw_value:e.z.string(),raw_value_decimals:e.z.number(),display_values:e.z.record(e.z.union([ze,ue]),e.z.string())}),me=e.z.object({balances:e.z.array(he.refine((e=>e.asset in e.display_values),{message:"display_values must include the asset as a key",path:["display_values"]}))}),_e=e.z.object({id:e.z.string()}),be=e.z.object({id:e.z.string(),display_name:e.z.string().nullable(),public_key:e.z.string(),role:g,created_at:e.z.number()}),xe=e.z.object({id:e.z.string(),display_name:e.z.string().nullable(),public_key:e.z.string(),created_at:e.z.number()}),ye=i.Pagination.extend({chain_type:Y.optional()}).strict(),je=e.z.object({policy_ids:ne,authorization_key_ids:e.z.array(e.z.string()).optional(),authorization_threshold:e.z.number().optional(),additional_signers:oe.optional()}).strict().superRefine(((e,t)=>{Object.values(e).every((e=>null==e))&&t.addIssue({code:"custom",message:"At least one field must be provided"}),void 0!==e.authorization_threshold&&0!==e.authorization_threshold&&(e.authorization_threshold<0&&t.addIssue({code:"custom",path:["authorization_threshold"],message:"`authorization_threshold` must be non-negative if specified."}),void 0===e.authorization_key_ids&&t.addIssue({code:"custom",path:["authorization_key_ids"],message:"An array of `authorization_key_ids` must be provided for a non-zero `authorization_threshold`."}),e.authorization_key_ids&&e.authorization_threshold>e.authorization_key_ids.length&&t.addIssue({code:"custom",path:["authorization_threshold"],message:"`authorization_threshold` must be non-negative if specified."}))})),Ae=i.Pagination.extend({chain:e.z.literal("base"),asset:e.z.union([ze,e.z.array(ze).max(2)])}).strict(),Ie=e.z.object({type:e.z.literal("transfer_sent"),sender:e.z.string(),sender_privy_user_id:e.z.string().nullable(),recipient:e.z.string(),recipient_privy_user_id:e.z.string().nullable()}).strict().merge(he),ve=e.z.object({type:e.z.literal("transfer_received"),sender:e.z.string(),sender_privy_user_id:e.z.string().nullable(),recipient:e.z.string(),recipient_privy_user_id:e.z.string().nullable()}).strict().merge(he),Re=e.z.discriminatedUnion("type",[Ie,ve]),We=r.BaseTransactionResponse.extend({details:Re.nullable()}),Se=We.extend({privy_transaction_id:e.z.string(),wallet_id:e.z.string()}),Te=e.z.object({transactions:e.z.array(Se),next_cursor:e.z.string().nullable()});exports.AdditionalSignerInput=oe,exports.Asset=ze,exports.AssetAmountDetails=he,exports.AuthorizationKeyDashboardResponse=be,exports.AuthorizationKeyResponse=xe,exports.AuthorizationKeyRole=g,exports.BalanceFiatCurrency=ue,exports.BaseWalletApiCreateInput=se,exports.CAIP2=z,exports.ChainNameInput=de,exports.ChainType=Y,exports.Cosmos=V,exports.CurveSigningChainTypes=J,exports.CurveType=o,exports.ECDSA=l,exports.EdDSA=p,exports.FirstClassChainTypes=X,exports.HDPath=s,exports.Hash=x,exports.Hex=b,exports.KeyQuorumId=te,exports.OwnerInput=ae,exports.OwnerInputFields=re,exports.P256PublicKey=ie,exports.PolicyInput=ne,exports.PrivyTransactionResponseWithDetails=Se,exports.Quantity=j,exports.SigningAlgorithm=c,exports.Stellar=$,exports.Sui=Z,exports.TransactionDetail=Re,exports.TransactionResponseWithDetails=We,exports.TransferReceivedTransactionDetail=ve,exports.TransferSentTransactionDetail=Ie,exports.TypedDataDomainInputParams=D,exports.TypedDataTypesInputParams=P,exports.UnsignedEthereumTransaction=A,exports.WalletApiCreateInput=le,exports.WalletApiCreateResponse=pe,exports.WalletApiEthereumPersonalSignRpcInput=W,exports.WalletApiEthereumPersonalSignRpcInputParams=R,exports.WalletApiEthereumPersonalSignRpcResponse=O,exports.WalletApiEthereumRpcInput=k,exports.WalletApiEthereumSecp256k1SignRpcInput=S,exports.WalletApiEthereumSecp256k1SignRpcResponse=F,exports.WalletApiEthereumSendTransactionRpcInput=v,exports.WalletApiEthereumSendTransactionRpcResponse=M,exports.WalletApiEthereumSignTransactionRpcInput=I,exports.WalletApiEthereumSignTransactionRpcResponse=U,exports.WalletApiEthereumSignTypedDataRpcInput=f,exports.WalletApiEthereumSignTypedDataRpcResponse=G,exports.WalletApiExportPrivateKeyRpcInput=E,exports.WalletApiExportPrivateKeyRpcResponse=H,exports.WalletApiRawSignInput=T,exports.WalletApiRawSignResponse=N,exports.WalletApiRegisterAuthorizationKeyInput=Q,exports.WalletApiRevokeAuthorizationKeyInput=_e,exports.WalletApiRpcInput=C,exports.WalletApiRpcResponse=L,exports.WalletApiSolanaRpcInput=w,exports.WalletApiSolanaSignAndSendTransactionRpcInput=m,exports.WalletApiSolanaSignAndSendTransactionRpcResponse=q,exports.WalletApiSolanaSignMessageRpcInput=_,exports.WalletApiSolanaSignMessageRpcResponse=B,exports.WalletApiSolanaSignTransactionRpcInput=h,exports.WalletApiSolanaSignTransactionRpcResponse=K,exports.WalletGetBalanceInput=ge,exports.WalletGetBalanceResponse=me,exports.WalletGetTransactionsInput=Ae,exports.WalletGetTransactionsResponse=Te,exports.WalletIdFromPath=ce,exports.WalletResponse=ee,exports.WalletUpdateInput=je,exports.WalletsSearchInput=ye;
