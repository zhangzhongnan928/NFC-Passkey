"use strict";var t=require("../../Error.js");exports.loginWithCrossAppAuth=({client:r,openAuthSession:e})=>async({providerAppId:i,redirectUrl:a})=>{let o=`privy:${i}`,{url:n}=await r.auth.oauth.generateURL(o,a),s=await e(n),u=s.privy_oauth_state,h=s.privy_oauth_code;if(!u||!h)throw new t.PrivyClientError({code:"login_with_oauth_returned_with_invalid_credentials",error:"Auth session oauth returned invalid credentials"});let p=await r.auth.oauth.loginWithCode(h,u,o),d=p.oauth_tokens;return d&&await r.crossApp.updateOnCrossAppAuthentication(i,d),p};
